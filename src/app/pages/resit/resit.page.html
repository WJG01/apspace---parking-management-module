<ion-header>
  <ion-toolbar mode="md">
    <ion-title>Resit</ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button (click)="addResit()">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher pullMax="400" pullMin="60" slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content refreshing-spinner="dots" pullingIcon="refresh"></ion-refresher-content>
  </ion-refresher>

  <div class="glob-container">
    <ion-row>
      <ion-col size="12" size-lg="4" push-lg="8">
        <ion-card class="ion-no-margin">
          <ng-container *ngIf="(registrationDate$ | async) as registrationDates">
            <ion-item-divider lines="none" color="light">
              <ion-label class="glob-text-bold" color="primary">
                Active Registration Date
              </ion-label>
            </ion-item-divider>
            <ion-item class="active-resit"
              *ngFor="let active of registrationDates.current_active_registration_date; let isLast = last"
              [lines]="isLast ? 'none' : undefined">
              <ion-label>
                <h2 class="glob-text-bold">{{ active.registration_start_date | date: 'dd MMMM y' }}</h2>
                <p>Ends: {{ active.registration_end_date | date: 'dd MMMM y' }}</p>
              </ion-label>
            </ion-item>

            <ion-item-divider lines="none" color="light">
              <ion-label class="glob-text-bold" color="primary">
                Next Registration Date
              </ion-label>
            </ion-item-divider>
            <ion-item *ngFor="let next of registrationDates.next_registration_date; let isLast = last"
              [lines]="isLast ? 'none' : undefined">
              <ion-label>
                <h2 class="glob-text-bold">{{ next.registration_start_date | date: 'dd MMMM y' }}</h2>
                <p>Ends: {{ next.registration_end_date | date: 'dd MMMM y' }}</p>
              </ion-label>
            </ion-item>
          </ng-container>
        </ion-card>
      </ion-col>

      <ion-col size="12" size-lg="8" pull-lg="4">
        <ion-card class="ion-no-margin">
          <ion-item-divider lines="none" color="light">
            <ion-label class="glob-text-bold" color="primary">
              All Resit Registration Date
            </ion-label>
          </ion-item-divider>

          <ng-container *ngIf="(resit$ | async) as resits">
            <ion-item button="true" detail="true" *ngFor="let r of resits; let isLast = last"
              [lines]="isLast ? 'none' : undefined" (click)="updateResit(r)">
              <ion-label>
                <h2 class="glob-text-bold">{{ r.registration_start_date | date: 'dd MMMM y' }}</h2>
                <p>Ends: {{ r.registration_end_date | date: 'dd MMMM y' }}</p>
              </ion-label>
            </ion-item>
          </ng-container>
        </ion-card>
      </ion-col>
    </ion-row>
  </div>
</ion-content>
